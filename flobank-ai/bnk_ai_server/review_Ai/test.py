from transformers import AutoModelForCausalLM, AutoTokenizer
import torch

model_name = "konantech/Konan-LLM-OND"

print("🔹 모델 로드 중... (처음엔 다소 오래 걸립니다)")
tokenizer = AutoTokenizer.from_pretrained(model_name)
model = AutoModelForCausalLM.from_pretrained(model_name, torch_dtype=torch.float16, low_cpu_mem_usage=True)

print("✅ 모델 로드 완료")

# 테스트 문장
prompt = """다음 내용을 세 문장으로 요약해줘:
 "내년 달러화는 점진적 약세가 예상되는 가운데, 원·달러 환율은 올해에 이어 높은 변동성을 보일 것으로 전망됐습니다.
대외경제정책연구원(KIEP)은 오늘(11일) ‘2026년 세계경제 전망’에서 이같이 분석했습니다.
연구원은 “내년 연준의 금리인하 기조가 지속되면서 점진적 약세가 예상되지만, 트럼프 행정부의 무역정책 방향이 달러 가치에 결정적 영향을 미칠 전망”이라고 밝혔습니다.
미국 경제 성장이 둔화하고 실업률이 오를 걸로 전망된다며, 미국 연준이 기준 금리를 내리고 통화량을 늘리면서 달러가 약해질 수 있다고 내다봤습니다.
트럼프 행정부가 약달러를 선호하며, 적극적으로 정책 개입에 나설 것으로 보이는 점도 달러 약세 요인으로 봤습니다.
다만, “지정학적 리스크 심화 시 안전 자산 수요로 달러가 강세를 보일 수 있어 방향성에 불확실성이 존재한다”고 설명했습니다.
한편, 미국의 재정 우려로 인한 장기 국채금리 상승 압력과 외국인 투자자들의 미국 국채 보유 비중 감소는 중장기적으로 달러 약세 요인으로 작용할 것이라고도 짚었습니다.
내년 원·달러 환율은 이 같은 달러 약세 등으로 강세 압력을 받을 거로도 예상됐습니다.
특히 내년 4월부터 세계 3대 채권지수인 세계국채지수(WGBI)에 우리나라가 편입되는 것과 관련해, 보고서는 “(편입이) 현실화할 경우 대규모 패시브 자금(지수 추종 등 장기적으로 운용되는 자금)이 유입될 전망이며, 이는 지수 추종 자금의 특성상 단기 유출 가능성이 낮아 원화 강세의 구조적 요인으로 작용할 가능성이 있다”고 분석했습니다.
이 밖에도 원화 강세 요인으로는 기업 밸류업 정책에 따른 주식 시장 매력도 제고와 반도체 수출 호조가 있다고 설명했습니다.
반면 주요 약세 요인으론 가계부채와 같은 구조적 제약과 미국 관세 효과, 중국 의존도가 높은 무역 구조 등이 거론됐습니다.
보고서는 “GDP 대비 90% 후반의 높은 가계부채는 소비 제약과 통화정책 여력 제한을 통해 구조적 원화 약세 요인으로 작용하며, 부동산 시장 조정 장기화 시 내수 회복을 지연시킬 위험이 있다”고 분석했습니다.
특히 “미국과의 무역협상에서 (결정된) 미국산 에너지의 대규모 구매 및 대미 투자를 이행할 경우 경상수지 악화 요인이 돼 원화에 부담으로 작용할 가능성이 있다”라고도 설명했습니다.
이어 지정학적 긴장이 고조되고, 미국이 반도체 추가 관세를 부과할 경우, 또 중국 경제가 급격히 둔화할 경우 원화의 급격한 약세를 촉발할 수 있다고도 분석했습    니다.
보고서는 주요 국제 투자 은행들은 내년 1분기엔 원/달러 환율이 1,370원, 2분기엔 1,355원 수준까지 하락할 거로 전망하고 있다고도 보고서는 전했습니다." """

# 입력 인코딩
inputs = tokenizer(prompt, return_tensors="pt")

# 추론
with torch.no_grad():
    outputs = model.generate(
        **inputs,
        max_new_tokens=100,
        do_sample=False,
        pad_token_id=tokenizer.eos_token_id,
    )

print("\n🧩 결과:")
print(tokenizer.decode(outputs[0], skip_special_tokens=True))
