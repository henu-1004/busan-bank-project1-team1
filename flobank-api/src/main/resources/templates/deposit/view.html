<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>외화 예금 상품 상세</title>
    <link rel="stylesheet" th:href="@{/css/deposit.css}">
    <link rel="stylesheet" th:href="@{/css/header.css}">
    <link rel="stylesheet" th:href="@{/css/footer.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" crossorigin="anonymous"/>
</head>
<body>
<div th:replace="~{_template/_header.html}"></div>

<main class="view-main">

    <div th:replace="~{deposit/_side.html}"></div>

    <section class="view-container">

        <div class="view-header">
            <div class="view-image">
                <img th:src="@{/images/character8.png}" alt="외화 예금 아이콘">
            </div>

            <div class="view-textbox">
                <h2 th:text="${product.dpstName}">상품명</h2>
                <p class="view-summary" th:utext="${product.dpstInfo}">상품 요약 설명</p>

                <div class="view-summary-info">
                    <div class="view-info-item">
                        <span class="view-info-label">가입대상</span>
                        <span class="view-info-value">
                            <span th:if="${product.dpstMinAge != null and product.dpstMinAge > 0}">
                                <span th:if="${product.dpstMaxAge != null and product.dpstMaxAge > 0}"
                                      th:text="|만 ${product.dpstMinAge}세 ~ 만 ${product.dpstMaxAge}세|"></span>
                                <span th:if="${product.dpstMaxAge == null or product.dpstMaxAge == 0}"
                                      th:text="|만 ${product.dpstMinAge}세 이상|"></span>
                            </span>
                            <span th:if="${product.dpstMinAge == null or product.dpstMinAge == 0}">제한 없음</span>
                        </span>
                    </div>

                    <div class="view-info-item">
                        <span class="view-info-label">가입기간</span>
                        <span class="view-info-value">
                           <span th:if="${product.periodList == null or product.periodList.isEmpty()}">기간 정보 없음</span>
                           <th:block th:each="period, stat : ${product.periodList}">
                               <th:block th:if="${product.dpstPeriodType == 1}">
                                   <span th:if="${period.minMonth != null and period.maxMonth != null}" th:text="|${period.minMonth}개월 ~ ${period.maxMonth}개월|"></span>
                                   <span th:if="${period.minMonth != null and period.maxMonth == 0}" th:text="|${period.minMonth}개월 이상|"></span>
                               </th:block>
                               <th:block th:if="${product.dpstPeriodType == 2}">
                                   <span th:text="|${period.fixedMonth}개월|"></span>
                               </th:block>
                               <span th:if="${!stat.last}">, </span>
                           </th:block>
                        </span>
                    </div>

                    <div class="view-info-item">
                        <span class="view-info-label">가입금액</span>
                        <div class="view-info-value" style="display: flex; flex-direction: column; gap: 6px;">
                            <th:block th:if="${product.limits != null and !product.limits.isEmpty()}">
                                <div th:each="limit : ${product.limits}" style="display: flex; align-items: center;">
                                    <span style="width: 50px; display: inline-block; font-weight: 700; color: #22304E;" th:text="${limit.lmtCurrency}">USD</span>
                                    <span style="color: #333;">
                                        <span th:text="${#numbers.formatInteger(limit.lmtMinAmt, 1, 'COMMA')}">1,000</span>
                                        <span th:if="${limit.lmtMaxAmt != null and limit.lmtMaxAmt > 0}"
                                              th:text="| ~ ${#numbers.formatInteger(limit.lmtMaxAmt, 1, 'COMMA')}|"></span>
                                    </span>
                                </div>
                            </th:block>
                            <div th:if="${product.limits == null or product.limits.isEmpty()}" style="color: #333;">제한 없음</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="view-tabs">
            <button class="view-tab active" onclick="openTab(event, 'tab1')">상품안내</button>
            <button class="view-tab" onclick="openTab(event, 'tab2')">금리안내</button>
            <button class="view-tab" onclick="openTab(event, 'tab3')">상품약관</button>
        </div>

        <div id="tab1" class="view-details view-content active">

            <dl class="view-detail" th:if="${product.dpstDescript != null}">
                <dt>특징</dt>
                <dd th:utext="${product.dpstDescript}">상품 설명</dd>
            </dl>

            <dl class="view-detail">
                <dt>가입 대상</dt>
                <dd>
                    <span th:if="${product.dpstMinAge > 0}" th:text="|만 ${product.dpstMinAge}세 이상|"></span>
                    <span th:unless="${product.dpstMinAge > 0}">제한 없음</span>
                </dd>
            </dl>

            <dl class="view-detail">
                <dt>예금 유형</dt>
                <dd th:text="${product.dpstType == 1 ? '거치식 예금' : (product.dpstType == 2 ? '자유 적립식' : '기타')}"></dd>
            </dl>

            <dl class="view-detail">
                <dt>가입 가능 통화</dt>
                <dd>
                    <span th:each="cur, stat : ${#strings.arraySplit(product.dpstCurrency, ',')}">
                        <span th:text="${cur}"></span><span th:if="${!stat.last}">, </span>
                    </span>
                </dd>
            </dl>

            <dl class="view-detail">
                <dt>예금액</dt>
                <dd>
                    <div style="display: flex; flex-direction: column; gap: 4px;">
                        <th:block th:if="${product.limits != null and !product.limits.isEmpty()}">
                            <div th:each="limit : ${product.limits}">
                                <span style="font-weight: 600; color: #22304E;" th:text="${limit.lmtCurrency}">USD</span>
                                <span th:switch="${limit.lmtCurrency}" style="color: #666; margin-right: 4px;">
                                    <span th:case="'USD'">($)</span><span th:case="'JPY'">(¥)</span>
                                    <span th:case="'EUR'">(€)</span><span th:case="'GBP'">(£)</span>
                                    <span th:case="'CNY'">(¥)</span><span th:case="'AUD'">(A$)</span>
                                </span>
                                <span th:text="${#numbers.formatInteger(limit.lmtMinAmt, 1, 'COMMA')}"></span>
                                <span th:if="${limit.lmtMaxAmt != null and limit.lmtMaxAmt > 0}"
                                      th:text="| ~ ${#numbers.formatInteger(limit.lmtMaxAmt, 1, 'COMMA')}|"></span>
                            </div>
                        </th:block>
                        <span th:if="${product.limits == null or product.limits.isEmpty()}">제한 없음</span>
                    </div>
                </dd>
            </dl>

            <dl class="view-detail">
                <dt>추가납입</dt>
                <dd>
                    <th:block th:if="${product.dpstAddPayYn == 'Y'}">
                        <div style="font-weight: 700; color: #2C5DE5; margin-bottom: 4px;">가능</div>
                        <div style="font-size: 14px; color: #666;">신규 포함 최대 <strong th:text="${product.dpstAddPayMax}" style="color: #222;"></strong>회</div>
                    </th:block>
                    <th:block th:if="${product.dpstAddPayYn == 'N'}">
                        <div style="color: #d12a2a; font-weight: 700;">불가능</div>
                    </th:block>
                </dd>
            </dl>

            <dl class="view-detail">
                <dt>예금 가입 기간</dt>
                <dd>
                    <span th:if="${product.periodList == null or product.periodList.isEmpty()}">별도 제한 없음</span>
                    <th:block th:each="period, stat : ${product.periodList}">
                        <th:block th:if="${product.dpstPeriodType == 1}">
                             <span th:if="${period.minMonth != null and period.maxMonth != null and period.maxMonth > 0}"
                                   th:text="|${period.minMonth}개월 이상 ~ ${period.maxMonth}개월 이하|"></span>
                            <span th:if="${period.minMonth != null and (period.maxMonth == null or period.maxMonth == 0)}"
                                  th:text="|${period.minMonth}개월 이상|"></span>
                        </th:block>
                        <th:block th:if="${product.dpstPeriodType == 2}">
                            <span th:if="${period.fixedMonth != null and period.fixedMonth > 0}"
                                  th:text="|${period.fixedMonth}개월|"></span>
                        </th:block>
                        <span th:if="${!stat.last}">, </span>
                    </th:block>
                </dd>
            </dl>

            <dl class="view-detail" th:if="${product.dpstPartWdrwYn == 'Y'}">
                <dt>일부 출금</dt>
                <dd>
                    ・ 대상 계좌: 가입일로부터 <span th:text="${product.wdrwMinMonth}"></span>개월 이상 지난 계좌<br>
                    ・ 가능 횟수: 최대 <span th:text="${product.wdrwMax}"></span>회<br>
                    ・ 최소 출금금액: <span th:text="${product.amtCurrency}"></span>
                    <span th:text="${#numbers.formatInteger(product.amtMin, 3, 'COMMA')}"></span> 이상
                </dd>
            </dl>

            <dl class="view-detail">
                <dt>가입할 수 있는 곳</dt>
                <dd>FLOBANK 웹사이트 및 모바일 앱</dd>
            </dl>

            <dl class="view-detail">
                <dt>이자 받는 방법</dt>
                <dd>만기 시 한 번에 지급 (만기일시지급식)</dd>
            </dl>

            <dl class="view-detail">
                <dt>세제 혜택</dt>
                <dd>없음</dd>
            </dl>

            <div class="view-protection">
                <img th:src="@{/images/deposit.png}" alt="예금자보호 로고">
                <p>이 예금은 <strong>예금자보호법</strong>에 따라 원금과 소정의 이자를 합하여 <strong>1인당 “1억원까지”</strong> 보호됩니다.</p>
            </div>
        </div>


        <div id="tab2" class="view-content">

            <dl class="view-detail">
                <dt>외화정기예금금리</dt>
                <dd class="date-picker-area">
                    <label for="searchDate">조회기준일</label>
                    <input type="date" id="searchDate">
                </dd>
            </dl>

            <div class="unit-text" style="text-align: right; font-size: 12px; color: #666; margin-bottom: 5px;">(세전, 연 %)</div>

            <div class="table-wrap">
                <table class="tbl-basic">
                    <colgroup>
                        <col style="width: 120px;">
                        <col span="12" style="width: 80px;">
                    </colgroup>
                    <thead>
                    <tr>
                        <th scope="col">통화</th>
                        <th scope="col">1개월이상</th>
                        <th scope="col">2개월이상</th>
                        <th scope="col">3개월이상</th>
                        <th scope="col">4개월이상</th>
                        <th scope="col">5개월이상</th>
                        <th scope="col">6개월이상</th>
                        <th scope="col">7개월이상</th>
                        <th scope="col">8개월이상</th>
                        <th scope="col">9개월이상</th>
                        <th scope="col">10개월이상</th>
                        <th scope="col">11개월이상</th>
                        <th scope="col">12개월이상</th>
                    </tr>
                    </thead>
                    <tbody id="rateTableBody">
                    <tr>
                        <td colspan="13" class="no-data" style="padding: 30px; text-align: center; color: #999;">조회할 날짜를 선택해주세요.</td>
                    </tr>
                    </tbody>
                </table>
            </div>

            <dl class="view-detail" style="margin-top: 30px;">
                <dt>이자지급방식</dt>
                <dd>만기일시지급식</dd>
            </dl>

            <dl class="view-detail">
                <dt>적용환율</dt>
                <dd>
                    외화예금을 원화로 입금(신규 입금 포함)하는 경우, 입금 시점의 대고객 전신환매도율을 적용합니다.<br>
                    외화예금의 원금 및 이자를 원화로 지급할 때는 지급 시점의 대고객 전신환매입율을 적용합니다.
                </dd>
            </dl>

            <h3 class="view-subtitle">중도해지금리</h3>
            <p class="view-note">가입일 당시 고시한 중도해지금리 적용 (세금공제 전)</p>
            <table class="view-rate-table">
                <thead>
                <tr>
                    <th>예치기간</th>
                    <th>적용금리</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>가입기간 10% 미만</td>
                    <td>기본금리 × 10% × 경과일수/계약일수 (최저 연 0.10%)</td>
                </tr>
                <tr>
                    <td>가입기간 10% 이상 ~ 30% 미만</td>
                    <td>기본금리 × 30% × 경과일수/계약일수 (최저 연 0.30%)</td>
                </tr>
                <tr>
                    <td>가입기간 30% 이상 ~ 80% 미만</td>
                    <td>기본금리 × 50% × 경과일수/계약일수 (최저 연 0.50%)</td>
                </tr>
                <tr>
                    <td>가입기간 80% 이상</td>
                    <td>기본금리 × 90% × 경과일수/계약일수 (최저 연 0.50%)</td>
                </tr>
                </tbody>
            </table>

            <h3 class="view-subtitle">만기후금리</h3>
            <table class="view-rate-table">
                <thead>
                <tr>
                    <th>경과기간</th>
                    <th>적용금리</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>1개월 이내</td>
                    <td>기본금리 × 50%</td>
                </tr>
                <tr>
                    <td>1개월 초과</td>
                    <td>기본금리 × 30% (최저 연 0.20%)</td>
                </tr>
                </tbody>
            </table>
        </div>


        <div id="tab3" class="view-content">
            <ul class="view-terms-list">
                <li>
                    <a th:href="@{${termsFilePath != null ? termsFilePath : '#'}}"
                       th:target="${termsFilePath != null ? '_blank' : '_self'}">
                        <span>상품별적용약관동의</span>
                        <i class="fa-solid fa-angle-right"></i>
                    </a>
                </li>
                <li>
                    <a th:href="@{${product.dpstInfoPdf}}" target="_blank">
                        <span th:text="|${product.dpstName} 상품설명서|">상품설명서</span>
                        <i class="fa-solid fa-angle-right"></i>
                    </a>
                </li>
            </ul>
        </div>


        <!-- 공시승인번호 영역 -->
        <div class="view-approval-box" style="border-top: 1px solid #eee; padding-top: 20px; margin-top: 40px;">

            <h3 style="font-size: 18px; font-weight: 700; margin-bottom: 10px;">공시승인번호</h3>

            <p style="font-size: 14px; color: #666; margin-bottom: 12px;">
                이 내용은 법령 및 내부통제기준에 따른 광고관련 절차를 준수하였습니다.
            </p>

            <p style="font-size: 15px; color: #333; margin-bottom: 6px;">
                준법감시인 심의필
                <strong th:text="${product.dpstDelibNo}">2025-0786</strong>
                (심의일자 :
                <span th:text="${#temporals.format(delibDate, 'yyyy.MM.dd')}">2025.04.22</span>
                )
            </p>

            <p style="font-size: 15px; color: #333;">
                유효기일
                <span th:text="${#temporals.format(startDate, 'yyyy.MM.dd')}">2025.04.25</span>
                ~
                <span th:text="${#temporals.format(startDate.plusYears(1).minusDays(1), 'yyyy.MM.dd')}">
                        2026.04.24
                    </span>
            </p>

        </div>



        <div class="view-bottom">
            <a th:href="@{/deposit/list}" class="view-btn-link">
                <span>목록</span>
            </a>
            <a class="view-btn-primary"
               th:href="@{/deposit/deposit_step1(dpstId=${product.dpstId})}">
                가입하기
            </a>
        </div>

    </section>
</main>

<div th:replace="~{_template/_footer.html}"></div>
<script th:src="@{/js/deposit.js}"></script>
</body>
</html>