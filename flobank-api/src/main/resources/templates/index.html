<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FLOBANK 메인화면_외환_1조</title>

    <link rel="stylesheet" th:href="@{/css/index.css}">
    <link rel="stylesheet" th:href="@{/css/header.css}">
    <link rel="stylesheet" th:href="@{/css/footer.css}">

    <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
            crossorigin="anonymous"
    />

</head>
<body>
<div th:replace="~{_template/_header.html}"></div>

<section class="main-banner">
    <div class="slider">
        <div class="slides">
            <div class="slide">
                <a href="#"><img th:src="@{/images/banner2.png}" alt="banner1"></a>
            </div>
            <div class="slide">
                <a href="#"><img th:src="@{/images/banner1.png}" alt="banner2"></a>
            </div>
            <div class="slide">
                <a href="#"><img th:src="@{/images/banner3.png}" alt="banner3"></a>
            </div>
            <div class="slide">
                <a href="#"><img th:src="@{/images/banner4.png}" alt="banner4"></a>
            </div>
        </div>
    </div>

    <button class="prev"><i class="fa-solid fa-chevron-left"></i></button>
    <button class="next"><i class="fa-solid fa-chevron-right"></i></button>

    <div class="dots">
        <span class="dot active"></span>
        <span class="dot"></span>
        <span class="dot"></span>
        <span class="dot"></span>
    </div>
</section>

<section class="foreign-section">
    <div class="foreign-container">
        <div class="foreign-item">
            <a href="javascript:void(0);" onclick="goKoAccountOpenMain();">
                입출금계좌 개설
            </a>
            <p>언제 어디서나 간편하게</p>
        </div>
        <div class="foreign-item">
            <a th:href="@{/exchange/step1}">환전</a>
            <p>다양한 통화, 실시간 환율</p>
        </div>
        <div class="foreign-item">
            <a th:href="@{/remit/en_transfer_1}">외화송금</a>
            <p>빠르고 안전한 해외송금</p>
        </div>
        <div class="foreign-item">
            <a th:href="@{/rate/rate_calc}">환율계산기</a>
            <p>실시간 환율 계산</p>
        </div>
        <div class="foreign-item">
            <a th:href="@{/customer/notice_list}">공지사항</a>
            <p>플로뱅크의 알림사항</p>
        </div>
    </div>
</section>


<section class="briefing-section">
    <div class="briefing-container">

        <div class="briefing-box">
            <div class="briefing-top">
                <div class="briefing-tabs">
                    <a href="#" data-mode="oneday"
                       th:class="${briefingMode} == 'oneday' ? 'active' : ''">
                        오늘의 브리핑
                    </a>

                    <a href="#" data-mode="recent5"
                       th:class="${briefingMode} == 'recent5' ? 'active' : ''">
                        최근 5일 브리핑
                    </a>
                </div>
                <div class="more">
                    <a id="briefing-more" th:href="@{/articles(mode=${briefingMode})}">+ 더보기</a>
                </div>
            </div>

            <!-- 동적 제목 + 날짜 -->
            <h3>
                <span data-briefing-title th:text="${briefingTitle}">오늘의 브리핑</span>
                <span data-briefing-date th:text="'(' + briefingDateText + ')'"></span>
            </h3>

            <!-- 브리핑 내용 -->
            <ul class="briefing-list" data-briefing-lines>
                <li th:each="line : ${briefingLines}"
                    th:text="${line}">
                </li>

                <!-- 브리핑이 없는 경우 -->
                <li th:if="${briefingLines == null}">
                    아직 생성된 브리핑이 없습니다.
                </li>
            </ul>
        </div>
    </div>
</section>


<section class="board-section">
    <div class="board-container">

        <div class="board-box">
            <h3>공지사항</h3>
            <ul>
                <li th:each="n : ${noticeList}">
                    <a th:href="@{/customer/notice_view/{id}(id=${n.boardNo})}"
                       th:text="${n.boardTitle}"></a>
                    <span th:text="${#temporals.format(n.boardRegDt, 'yyyy.MM.dd')}"></span>
                </li>
            </ul>


            <div class="more"><a th:href="@{/customer/notice_list}">+ 더보기</a></div>
        </div>

        <div class="board-box">
            <h3>이벤트</h3>
            <ul>
                <li th:each="e : ${eventList}">
                    <a th:href="@{/customer/event_view/{id}(id=${e.boardNo})}"
                       th:text="${e.boardTitle}"></a>
                    <span th:text="${#temporals.format(e.boardRegDt, 'yyyy.MM.dd')}"></span>
                </li>
            </ul>


            <div class="more"><a th:href="@{/customer/event_list}">+ 더보기</a></div>
        </div>

    </div>
</section>
<div th:replace="~{_template/_footer.html}"></div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const tabs = document.querySelectorAll('.briefing-tabs a');
        const titleEl = document.querySelector('[data-briefing-title]');
        const dateEl = document.querySelector('[data-briefing-date]');
        const linesEl = document.querySelector('[data-briefing-lines]');
        const moreLink = document.getElementById('briefing-more');

        function renderBriefing(data) {
            tabs.forEach(tab => {
                tab.classList.toggle('active', tab.dataset.mode === data.briefingMode);
            });

            titleEl.textContent = data.briefingTitle || '브리핑';
            dateEl.textContent = data.briefingDateText ? `(${data.briefingDateText})` : '';

            linesEl.innerHTML = '';
            if (data.briefingLines && data.briefingLines.length > 0) {
                data.briefingLines.forEach(line => {
                    const li = document.createElement('li');
                    li.textContent = line;
                    linesEl.appendChild(li);
                });
            } else {
                const li = document.createElement('li');
                li.textContent = '아직 생성된 브리핑이 없습니다.';
                linesEl.appendChild(li);
            }

            if (moreLink && data.briefingMode) {
                moreLink.href = `/flobank/articles?mode=${data.briefingMode}`;
            }
        }

        function fetchBriefing(mode) {
            fetch(`/flobank/api/briefing?mode=${mode}`)
                .then(res => res.json())
                .then(renderBriefing)
                .catch(() => {});
        }

        tabs.forEach(tab => {
            tab.addEventListener('click', (e) => {
                e.preventDefault();
                const mode = tab.dataset.mode;
                if (!mode) return;
                fetchBriefing(mode);
            });
        });
    });
</script>

</body>
</html>
